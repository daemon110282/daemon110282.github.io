# Подходы к проектированию

![design](https://miro.medium.com/max/720/1*lFGlOSW19H184tUt9DhvUg@2x.webp)

- [Дизайн API от потребностей продукта](http://agilemindset.ru/%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80%d0%b0/)
- Простота и удобство использования API потребителем [важнее простоты и удобства реализации поставщиком](https://systems.education/api-design)
- TODO [Сергей Константинов. API](https://twirl.github.io/The-API-Book/API.ru.html)
  - метод (__сигнатура__)
    - Стремитесь к тому, чтобы из __сигнатуры функции было абсолютно ясно, что она делает, что принимает на вход и что возвращает__. Вообще, при прочтении кода, работающего с вашим API, должно быть сразу понятно, что, собственно, он делает - без подглядывания в документацию.
    - Избегайте неявных частичных обновлений
    - Рекомендации по [наименованию](https://proglib.io/p/21-luchshiy-metod-vyvedet-vashi-navyki-proektirovaniya-api-na-novyy-uroven-2021-04-29) физических ресурсов, [свойств](https://proglib.io/p/15-luchshih-praktik-razrabotki-i-proektirovaniya-rest-api-2022-04-12)
    - Конечные точки в URL – [имя существительное, не глагол](https://habr.com/ru/post/351890/), Множественное число. Примеры:
      - https://{domain}/{service}/v1/customers/1
      - https://{domain}/{service}/{version}/{resourcepath}?fields={fieldId,*}
      - https://{domain}/files/v3/documents/ab34de    
  - свойства метода (__контракт\интерфейс__)
    - Указывайте использованные стандарты
    - При этом существует «золотое правило», применимое не только к API, но ко множеству других областей проектирования: человек комфортно удерживает в краткосрочной памяти __7±2 различных объекта__. Манипулировать большим числом сущностей человеку уже сложно. Это правило также известно как __«закон Миллера»__. Бороться с этим законом можно только одним способом: __декомпозицией__. На каждом уровне работы с вашим API нужно стремиться логически группировать сущности под одним именем там, где это возможно и таким образом, чтобы разработчику никогда не приходилось оперировать более чем 10 сущностями одновременно. Должны выделить в структуре __информационные домены__: какие поля логически относятся к одной предметной области.
    - Сущности должны именоваться конкретно
    - Тип поля должен быть ясен из его названия
  - __Возможные ошибки__
    - Должны быть информативными
    - Рекомендуется применить [смешанный подход](https://twirl.github.io/The-API-Book/API.ru.html#http-api-errors)
      - использовать HTTP Status Code согласно его семантике для индикации рода ошибки 
      - вложенные (мета)данные в специально разработанном формате для детализации ([RFC 7807 Problem Details for HTTP APIs](https://www.postman.com/postman/workspace/postman-open-technologies-openapi-governance-templates/api/5d100cae-09d7-4f77-91ae-48599d66bf04/definition/b78b2cef-d19b-487b-967f-c4d576007530?version=eec45873-dc44-4fa1-808d-df5fbdfe103d&view=documentation))
        - Ошибка – уникальный идентификатор ошибки (буквенный код, число) __в рамках ИС или модуля ИC__
        - Сообщение – краткое сообщение, понятное человеку
        - Detail — более подробное объяснение ошибки
  - Примеры запроса\ответа успешные\ошибки

## Качества хорошего API

[Критерии качественного API](https://twirl.github.io/The-API-Book/API.ru.html#chapter-3)

- API должен решать задачи максимально удобно и понятно
- Закладывание перспектив «на будущее» имеет смысл, только если это будущее у API есть, иначе это попросту __оверинжиниринг__.
- интерфейс API - __один сценарий использования (SRP)__
- очевидность
- читабельность
- консистентен: при разработке новой функциональности, т.е. при обращении к каким-то незнакомым сущностям в API, разработчик может действовать по аналогии с уже известными ему концепциями API, и его код будет работать.
