# Background Jobs

## Зачем

Функции процесса выполнения фоновых задач:

- Инициализация: процесс инициализации задачи, который может включать в себя определение ее параметров, установку соединения с базой данных и другое.
- Выполнение: фактическое выполнение задачи. Это включает в себя обработку данных, отправку электронной почты, генерацию отчетов и другое.
- Отслеживание статуса: процесс отслеживания статуса задачи, чтобы знать, на каком этапе она находится, была ли она выполнена успешно или произошла ошибка.
- Управление ошибками: процесс обработки и регистрации возможных ошибок, которые могут возникнуть в процессе выполнения задачи.
- Мониторинг: процесс мониторинга состояния системы и проверки наличия возможных проблем, таких как падение производительности или высокая загрузка процессора.
- Резервное копирование: создание резервных копий данных во время выполнения задачи, чтобы иметь возможность восстановления системы после возможной ошибки или сбоя.
- Отправка уведомлений: отправка уведомлений пользователю или администратору о состоянии задачи и ее выполнении.
- Планирование: процесс планирования задач на выполнение в будущем.
- Отчетность: создание отчетов о выполнении задач для анализа производительности и выявления проблем в работе системы.
- Завершение: завершение работы задачи и очистка ресурсов после ее выполнения

Требования:

- Создать классы-команды, каждый из которых будет выполнять определенное действие. Класс-команда должен содержать логику работы по обработке задачи.
- Создать класс CommandBus (шину команд), который будет отвечать за регистрацию и выполнение команд.
- В классе CommandBus добавить метод register на регистрацию команд.
- Добавить в класс CommandBus метод handle для выполнения соответствующей команды.
- Разработать механизм очереди, который будет хранить незавершенные задачи и обеспечивать их последовательную обработку.
- Использовать паттерн Observer для отслеживания завершения задачи.
- Реализовать функцию повторного запуска незавершенных задач в случае ошибок или исключительных ситуаций.
- Добавить возможность контроля за процессом выполнения задач с помощью системы логирования и мониторинга.
- Предусмотреть возможность расширения системы новыми типами команд.
- Обеспечить безопасность данных в процессе выполнения задач.

## Паттерны

Background Job - реализация  [Command Pattern](../../arch/pattern/command.md)
	- Feature
		- Retry
		- Priorited
		- Logging
		- Graceful Shutdow
		- Scalling Worker
		- Shedule
		- Event Pre\Post\Error
		- Rate Limit
		- Types (LIFO, Delayed, Prioritized, Repeatable)

- Abp.io support in [job](https://docs.abp.io/en/abp/4.4/Background-Jobs-RabbitMq)

