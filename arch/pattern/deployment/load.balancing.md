# Load Balancer Балансировка нагрузки

Метод распределения заданий между __несколькими сетевыми устройствами__ (например, серверами) с целью:

- __оптимизации использования ресурсов__
- сокращения времени обслуживания запросов
- горизонтального масштабирования кластера (динамическое добавление/удаление устройств)
- обеспечения отказоустойчивости (резервирования)

## Зачем

- отказоустойчивость и масштабирование
  - MariaDB и RabbitMQ в основе лежит разделение баз и брокеров по сервисам.

## Паттерны

- Необходимо на уровне ИС поддерживать
  - stateless ИС - Избегайте состояния (state) в вашем приложении
  - [Идемпотентность](../idempotent.md)
- [отказоустойчивость самого балансировщика](https://habr.com/ru/company/mailru/blog/474180/). Просто установка балансировщика тоже создаёт точку отказа: балансировщик ломается — сервис падает. Чтобы так не получалось, мы использовали HAProxy совместно с ExaBGP.
  - Балансировка HAProxy на базе DNS + BGP
  - Доступность haproxy: heartbeat между ExaBGP и HAProxy
  - синхронизировать сессии. При работе через распределенные балансировщики сложно организовать сохранение информации о сессиях клиентов. Но HAProxy — один из немногих балансировщиков, который умеет это за счёт функционала Peers — возможности передачи между различными процессами HAProxy таблицы сессий.

## Алгоритмы

[Алгоритмы](https://blog.bytebytego.com/i/103707419/what-are-the-common-load-balancing-algorithms)

![алгоритмы](../../../img/technology/lb.algoritm.jpg)

## Технологии

[Netscaler, HAProxy, Nginx..](../../../technology/loadbalancer.md)
