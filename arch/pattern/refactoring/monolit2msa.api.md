# Рефакторинг интеграций

- [Рефакторинг интеграций](#рефакторинг-интеграций)
  - [Зачем](#зачем)
    - [Паттерны](#паттерны)
      - [Рефакторинг синхронного взаимодействия](#рефакторинг-синхронного-взаимодействия)
      - [Рефакторинг асинхронного взаимодействия (шины сообщений)](#рефакторинг-асинхронного-взаимодействия-шины-сообщений)

Паттерны распила [монолита](../../style/monolit.md) на [MSA](../../style/msa.md)

## Зачем

Часть [рефакторинга монолита](monolit2msa.md).

### Паттерны

- Простой скрипт, кидающий запрос на 2 хоста и делающий diff

Вопросы:

- Выделен интеграционный слой, есть адаптер до API\RMQ, исп-ся паттерн Репозиторий?
- DBLink интеграции как переключить на АПИ НС?
  - В последнюю очередь?
  - CDC монолит -> НС

#### Рефакторинг синхронного взаимодействия

- Маршрутизация на API GW
- Трансформация форматов, протоколов, типов, технологий интеграций (SOAP2gRPC, REST2gROC, SOAP2REST и тп)
	- на API GW
    	- минусы: "умный" канал
	- на уровне ИС источника API поддержка нескольких форматов
		- минусы: в каждой ИС Потребителе потребуется доработка

#### Рефакторинг асинхронного взаимодействия (шины сообщений)

- Паттерн __Маршрутизация основанная на содержимом сообщений__
  - минусы: канал - шина сообщений становится "умной"
- Паттерн __Селективное потребление__
  - минусы: доработка монолита для игнорирования сообщений

