# CDC - Change Data Capture

- [Change Data Capture (CDC)](#change-data-capture-cdc)
	- [Зачем](#зачем)
		- [В чем преимущества change data capture систем?](#в-чем-преимущества-change-data-capture-систем)
		- [Критерии выбора CDC решения?](#критерии-выбора-cdc-решения)
		- [Отличие CDC от ETL?](#отличие-cdc-от-etl)
		- [При распиле монолита на сервисы где можно применить CDC?](#при-распиле-монолита-на-сервисы-где-можно-применить-cdc)
	- [Технологии](#технологии)
		- [Лучшие бесплатные CDC решения?](#лучшие-бесплатные-cdc-решения)

## Зачем

- позволяет [стримить информацию напрямую из таблиц](https://habr.com/ru/companies/vk/articles/519354/) на основе bin-log

### В чем преимущества change data capture систем?

Change Data Capture (CDC) - это метод записи и отслеживания изменений в базе данных. CDC системы предоставляют несколько преимуществ, которые могут быть полезными для разработчиков и аналитиков данных:

1. Синхронизация данных: CDC системы позволяют в режиме реального времени отслеживать и реплицировать изменения данных из одной базы данных в другую. Это особенно полезно при поддержке резервных копий, разделении нагрузки или создании отчетов на основе актуальных данных.

2. Отслеживание истории изменений: CDC системы сохраняют историю всех изменений данных. Это позволяет аналитикам анализировать, какие данные были изменены, когда и кем. История изменений также может быть полезна для отладки или в случае возникновения проблем с данными.

3. Минимизация задержек: CDC системы основаны на идентификации и захвате только измененных данных, а не всей базы данных. Это уменьшает задержки и нагрузку на систему, поскольку обработка данных происходит только для измененных записей.

4. Легкость интеграции: CDC системы обычно предоставляют API или интерфейсы для интеграции с другими приложениями и системами. Это упрощает процесс интеграции данных с различными инструментами и платформами.

5. Безопасность и целостность данных: CDC системы обеспечивают механизмы проверки целостности данных и контроля доступа. Это помогает предотвращать несанкционированный доступ к данным и обеспечивает сохранность и консистентность данных.

6. Улучшение производительности: CDC системы позволяют аналитикам и разработчикам избежать сложностей и затрат, связанных с полной перезагрузкой или репликацией данных каждый раз, когда необходимо получить актуальные данные. Вместо этого они могут использовать только измененные данные для выполнения своих задач.

В целом, CDC системы предоставляют более гибкие и эффективные возможности для работы с данными, что может значительно упростить разработку, анализ и управление базами данных.

### Критерии выбора CDC решения?

При выборе CDC решения следует учитывать следующие критерии:

1. Поддерживаемые источники данных: Убедитесь, что выбранная CDC система поддерживает используемые вами базы данных или другие источники данных. Уточните, имеется ли поддержка для всех систем, с которыми вы работаете.

2. Режим работы: Определите, требуется ли вам репликация данных в режиме реального времени или покадрово. Некоторые CDC системы предлагают только один из этих режимов, поэтому это важно учитывать при выборе.

3. Производительность: Изучите, какая производительность обеспечивается выбранным CDC решением. Узнайте, как оно обрабатывает большие объемы данных и насколько быстро может захватывать и реплицировать изменения.

4. Масштабируемость: Если вам нужно обрабатывать большие объемы данных или присоединять новые источники данных в будущем, убедитесь, что выбранное CDC решение поддерживает масштабируемость.

5. Интеграция исходящих систем: Рассмотрите, как легко интегрировать выбранную CDC систему с другими системами или приложениями, которые вы используете. Узнайте о наличии API, интерфейсов или инструментов интеграции.

6. Безопасность и целостность данных: Убедитесь, что выбранная CDC система обеспечивает надежную безопасность данных и контроль доступа. Важно, чтобы данные были защищены от несанкционированного доступа и сохранность была гарантирована.

7. Поддержка и обслуживание: Изучите, какая поддержка и обслуживание предоставляются выбранным CDC решением. Узнайте, какая документация и помощь доступны, если возникнут проблемы или вопросы.

8. Стоимость и лицензирование: Оцените стоимость выбранного CDC решения и определите, соответствует ли она вашему бюджету. Также учитывайте условия лицензирования и возможные дополнительные расходы.

9. Репутация и отзывы: Проведите исследование и ознакомьтесь с репутацией выбранного CDC решения. Ищите отзывы пользователей и оценки, чтобы оценить его надежность и эффективность.

10. Гибкость и настройка: Узнайте, какую гибкость предоставляет выбранное CDC решение для настройки и настройки по вашим требованиям. Это позволит вам лучше адаптировать его к уникальным потребностям вашей организации.

Учитывая эти критерии, вы сможете выбрать подходящее CDC решение, которое соответствует вашим требованиям и поможет эффективно работать с изменениями в данных.

### Отличие CDC от ETL?

CDC (Change Data Capture) и ETL (Extract, Transform, Load) являются двумя разными подходами к обработке данных. Вот их основные отличия:

1. Цель:
   - CDC: Целью CDC является захватывать и реплицировать изменения, происходящие в реальном времени в исходных базах данных, чтобы другие системы могли использовать эти обновленные данные.
   - ETL: Цель ETL состоит в извлечении данных из различных источников, их преобразовании и загрузке в целевую систему данных для анализа или хранения.

2. Временная задержка:
   - CDC: CDC обрабатывает изменения в режиме близком к реальному времени, что позволяет быстро обновлять данные в целевых системах.
   - ETL: ETL выполняет процесс пакетно, обычно с фиксированной периодичностью (например, ежедневно или ежечасно), поэтому между изменениями и их загрузкой может быть некоторая задержка.

3. Объем данных:
   - CDC: CDC обычно работает только с изменениями данных, поэтому объем передаваемых данных может быть гораздо меньше по сравнению с полным набором данных.
   - ETL: В процессе ETL извлекаются и загружаются все данные, которые должны быть обработаны в процессе трансформации, даже если они не были изменены. Поэтому объем данных, передаваемых в процессе ETL, может быть значительно больше.

4. Сложность:
   - CDC: CDC обычно имеет более простую архитектуру и требует меньшего количества инфраструктуры и ресурсов по сравнению с ETL.
   - ETL: ETL процесс обычно более сложный, так как включает в себя этапы извлечения, преобразования и загрузки данных, требующие определенных правил и логики.

5. Целевая система:
   - CDC: CDC захватывает изменения непосредственно из исходных баз данных и реплицирует их в целевые системы, где они могут быть использованы для различных целей, таких как отчетность или анализ.
   - ETL: ETL загружает данные из различных источников в целевую систему данных, где они могут быть структурированы и оптимизированы для конкретных потребностей анализа или хранения.

Оба подхода имеют свои преимущества и недостатки, и выбор между CDC и ETL зависит от конкретных требований и ситуации вашего проекта.

### При распиле монолита на сервисы где можно применить CDC?

CDC (Change Data Capture) при распиле монолита на сервисы можно применять в следующих случаях:

1. Обновление существующих сервисов: Если вы уже имеете существующие сервисы, но хотите обновить их, чтобы они могли использовать данные из других сервисов, то CDC может быть полезен. Вы можете захватывать изменения данных из других сервисов и реплицировать их в сервисы, которые нуждаются в этих данных.

2. Создание новых сервисов: При создании новых сервисов как часть распила монолита, CDC может быть использован для захвата и передачи данных из существующих баз данных монолита в новые сервисы. Это позволяет сохранить целостность данных и избежать дублирования информации.

3. Распределенная аналитика: Если вам необходимо проводить анализ данных, соответствующих различным сервисам, CDC может быть использован для захвата изменений из этих сервисов и передачи их в систему аналитики. Это позволяет получать актуальные данные для анализа без необходимости полного переноса данных.

4. Интеграция с внешними системами: Если ваш монолит должен интегрироваться с другими внешними системами, CDC может быть использован для захвата изменений в данных монолита и передачи их во внешние системы. Это обеспечивает актуальные данные для внешних систем и поддерживает синхронизацию информации.

5. Репликация данных: Если у вас есть несколько экземпляров сервисов или существуют географическое разделение данных, CDC может быть использован для репликации данных между этими экземплярами или местоположениями. Это помогает обеспечить консистентность данных и более высокую доступность.

Важно отметить, что применение CDC при распиле монолита на сервисы требует тщательного планирования и анализа, чтобы определить, какие данные должны быть захвачены и куда они должны быть реплицированы. Также учтите, что CDC требует настройки и управления инфраструктурой для захвата и передачи изменений данных.

## Плюсы и минусы

Плюсы:

Минусы:

## Технологии

- [Debezium](../../technology/cdc/debezium.md) - на базе Apache Kafka работает
- Zeebe
- QLik
- Hevo
- compare
  - [debezium vs Zeebe](https://habr.com/ru/companies/raiffeisenbank/articles/594117/)
  - [top 7](https://hevodata.com/learn/7-best-cdc-tools/)

### Лучшие бесплатные CDC решения?

1. Debezium: Это одно из самых популярных и широко используемых open-source решений CDC. Он интегрируется с различными базами данных, такими как MySQL, PostgreSQL, MongoDB и другими, и предоставляет механизм для захвата изменений данных и передачи их в целевую систему.

2. Apache Kafka: Хотя Kafka изначально не был разработан как CDC решение, он может использоваться для создания потоков данных и обмена сообщениями между системами. Путем интеграции с CDC-инструментом, таким как Debezium, Kafka можно использовать для захвата и передачи изменений данных.

3. Maxwell: Это еще одно популярное open-source CDC решение, которое интегрируется с MySQL и захватывает изменения данных, отправляя их на очередь сообщений, такую как Kafka или RabbitMQ. Maxwell имеет простой интерфейс и легко настраивается.

4. Bottled Water: Это CDC решение для PostgreSQL, которое захватывает изменения данных и стримит их в формате Avro через Kafka. Он прост в использовании и хорошо подходит для проектов, использующих PostgreSQL.

