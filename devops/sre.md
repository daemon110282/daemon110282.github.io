# Site Reliability Engineering (SRE) Надежность

- [Site Reliability Engineering (SRE) Надежность](#site-reliability-engineering-sre-надежность)
  - [Зачем](#зачем)
    - [ИТ услуга](#ит-услуга)
  - [Метрики](#метрики)
    - [Метрики оценки качества ИТ-сервиса](#метрики-оценки-качества-ит-сервиса)
    - [Бюджет ошибок](#бюджет-ошибок)
    - [SLI](#sli)
    - [Оповещения](#оповещения)
  - [Технологии](#технологии)

## Зачем

- Обеспечение эксплуатационной __надежности системы__, набор инженерных практик, поддерживающих надежную и __безотказную работу__ приложений в настоящем и будущем, с учетом __требуемой масштабируемости__ и внезапных форс-мажоров.
- Цель инженера по SRE — обеспечить __надёжную работу системы__
- Определяют, что такое [надёжность Reliability системы](../arch/ability/reliability.md), договариваются о показателях и вырабатывают стандарты действий в случае проблем
  - стабильность [resilience](../arch/ability/resilience.md)
  - доступность [availability](../arch/ability/availability.md)

### ИТ услуга

- __ИТ-услуга__ - услуга, предоставляемая поставщиком ИТ-услуг. ИТ-услуга включает в себя информационные технологии, процессы и людей. ИТ-услуга, ориентированная на Заказчика, непосредственно поддерживает бизнес-процессы одного или более Заказчиков.
- Бизнес-владелец - это основной заказчик услуги со стороны Бизнеса, использующий ее ценность для получения конечного результата.
- ИТ-владелец - это лицо, ответственное за управление ИТ-услугой в течение ее жизненного цикла, начиная с проектирования и заканчивая выводом из эксплуатации.
- Пользователь - лицо, использующее ИТ-услугу для выполнения конкретной функции или получения результатов ее функционирования.
- Операция по ИТ-услуге - любая предопределенная деятельность или транзакция

## Метрики

- __SLI__ - Service Level Indicator - индикаторы уровня обслуживания - __метрики__
- доступности вырабатываются вместе с продакт-оунером и закрепляются в соглашении о __целевом уровне__ обслуживания (метрик) — __Service-Level Objective (SLO)__ по определенным SLI  
- Service Level Agreement (__SLA__) - обязанности компании перед потребителями закрепляются. Это соглашение описывает работоспособность всего сервиса и штрафы за превышение времени простоя или другие нарушения
  - описывает ИТ-услугу
  - документирует целевые показатели качества услуги
  - указывает зоны ответственности сторон
  - заключается между Бизнес-владельцем и поставщиком ИТ-услуги

### Метрики оценки качества ИТ-сервиса

- [доступность](../arch/ability/availability.md) (availability)
- [производительность](../arch/ability/performance.md) (performance)
- [надежность](../arch/ability/reliability.md) (reliability)
- сопровождаемость (maintainability)
- обслуживаемость (serviceability)
- [безопасность](../arch/ability/security.md) (security)

### Бюджет ошибок

- __Бюджет ошибок__ — это допустимое количество ошибок за выбранный период. Мы считаем его, чтобы __измерить надёжность приложения__, так как отдельные метрики не дают полной картины.
- Наш бюджет ошибок — это ситуации, когда микросервис нарушает нефункциональные требования:
  - отдаёт ответ с одним из кодов (400, 500, 503, 504)
  - или отвечает слишком медленно (Latency 100 мс)
- Что даёт расчёт бюджета ошибок?
  - Микросервис становится предсказуемым. Например, если указать, что микросервис ответит за 300 мс в 99,9% случаев, то все прочие подключившиеся микросервисы будут ожидать ответ за это время.
  - Появляется простор для манёвров. Разработчики могут экспериментировать в рамках бюджета ошибок без риска положить сервис.

### SLI

Что мониторить:

- Client-side monitoring (Sentry и тп): Error, Performance
- [Network monitoring](https://cloud.google.com/blog/topics/partners/using-sentry-to-monitor-web-and-mobile-apps): Latency, Throughput, Utilization
  - CDN
  - Load Balancer
  - Router
  - DNS
  - VPCs
- Server-side [monitoring](../arch/ability/performance.metric.md)
  - system
  - application

### Оповещения

- [Бот, действия, ответственные](https://habr.com/ru/companies/oleg-bunin/articles/481874/)

## Технологии

- [Prometheus + Grafana. Настраиваем 4 golden signals](https://www.youtube.com/watch?v=Q_fKb0nrfCg&ab_channel=Слёрм)
  - [Demo project](https://github.com/s-buhar0v/4-golden-signals-demo)
- Стабильность [Sentry](https://vc.ru/dev/833250-kak-s-pomoshchyu-sentry-nahodit-i-bystro-ustranyat-oshibki)
